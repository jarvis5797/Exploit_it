from tkinter import *
import os
import time
from functools import partial
import subprocess
from tkinter import messagebox , ttk

win=Tk()

def VM_ip(host_ip):
	ip=(host_ip.get())
	ipv=ip+"/24"
	checkip=os.popen('ifconfig '+interface.get()+' | grep -Eo "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}"')
	hostip=checkip.read()
	ifconfig_list=hostip.split()
	if ip == ifconfig_list[0]:
		stream = os.popen('nmap -sP '+ipv+' | grep -Eo "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}"')
		output = stream.read()
		lst=output.split()
		for i in lst:
			if i==ip:
				lst.remove(i)
		a=len(lst)
		l1=Label(win,text="GOT "+str(a)+" host up >>> ",font="system 15",fg='white',bg='black')
		l1.place(x=1,y=300)
		l2=Label(win,text=lst,font="system 20",bg='black',fg='green')
		l2.place(x=200,y=300)
	else:
		messagebox.showinfo("NOT FOUND","It seems like Exploit is not happy with you:\n\n\n>>> Check for the intertent connection.\n\n>>>Check your host ip again.\n\n>>> Check that you have selected the correct interface or not.")



def pingIT(ping):
	ip=(ping.get())
	process = subprocess.run(['dig','+short',ip],
                         stdout=subprocess.PIPE,
                         universal_newlines=True)
	if process.stdout !="":
		messagebox.showinfo("Got an IP",process.stdout)
	else:
		messagebox.showinfo("Error","Please enter a valid domain name")

def scan_window():
	def open_port(scanip):
		ip_ad=(scanip.get())
		stream=os.popen('nmap '+ip_ad+' | grep open')
		output=stream.read()
		xa=1
		ya=1
		i=0
		if output =='' or ip_ad=='':
			messagebox.showinfo("can't find","check for the ip")
		else:
			ar=output.split()
			while i<=(len(ar)-3):
				l=Label(terminal,text=ar[i]+' '+ar[i+1]+' '+ar[i+2]+'\n',fg='blue',bg='black')
				l.place(x=xa,y=ya)
				ya+=20
				window.update()
				time.sleep(0.2)
				i=i+3
	def open_serv(scanip):
		ip_ad=(scanip.get())
		stream=os.popen('nmap -sV '+ip_ad+' | grep open')
		output=stream.read()
		if output=='' or ip_ad=='':
			messagebox.showinfo("Can't Find","check for the ip")
		else:
			l=Label(terminal,text=output,bg='black',fg='blue',wraplength=300)
			l.place(x=1,y=1)
	window=Toplevel()
	window.geometry("1366x768")
	window['bg']="black"
	window.title("Scanner")
	task_bg=PhotoImage(file="scanner.png")
	task=Frame(window,width=500,height=768,bd=10)
	task.place(x=1,y=1)
	terminal=Frame(window,width=866,height=768,bd=10,bg="black")
	terminal.place(x=500,y=1)

	lab=Label(task,image=task_bg)
	lab.image=task_bg
	lab.place(x=0,y=0)
	option=Label(task,text="OPTIONS",font="system 20 bold",bg="firebrick",fg="blue")
	label_1=Label(task,bg='firebrick',text="Enter  the  Target's  IP : ")
	label_1.place(x=2,y=100)

	scanip=StringVar()
	en=Entry(task,textvariable=scanip)
	en.place(x=200,y=100)
	open_port=partial(open_port,scanip)
	button_1=Button(task,text=" Open Ports\nScan",activebackground="green",command=open_port,bg='firebrick')
	button_1.place(x=180,y=150)
	open_serv=partial(open_serv,scanip)
	button_2=Button(task,text="Open ports and service\nScan",command=open_serv,bg='firebrick',activebackground='green')
	button_2.place(x=140,y=220)
	option.place(x=170,y=1)


win.geometry("1366x768")
logo=PhotoImage(file="logo.png")
win.configure(background="black")
win.title("Tool")
bg_logo=Label(win,image=logo,bd=0)
bg_logo.place(x=400,y=100)
label_1=Label(win,text="ExploIT",font="system 30 bold",bg='black',fg='red')
label_1.place(x=600,y=2)
label_2=Label(win,text="Let's get started with information gathering for our target",font="system 20",fg='blue',bg='black')
label_2.place(x=300,y=60)
label_3=Label(win,text="For websites:Enter the domain name to find the IP",font="arial 10",bg='black',fg='white')
label_3.place(x=5,y=120)
label_4=Label(win,text="For machines: Enter your host IP to find the Virtual machines IP",font="arial 10",bg='black',fg='white')
label_4.place(x=800,y=120)




interface=StringVar()
host_ip=StringVar()
ping=StringVar()
entry_1=Entry(win,textvariable=ping)
entry_1.place(x=1,y=150)
entry_2=Entry(win,textvariable=host_ip)
entry_2.place(x=800,y=150)
chose_interface=ttk.Combobox(win,text="interface",width=10,textvariable=interface,value=('eth0','wlan0'))
chose_interface.place(x=1000,y=150)

scan_window=partial(scan_window)
pingIT=partial(pingIT,ping)
findIp_button=Button(win,text="Find_IP",command=pingIT,bg='dark violet')
findIp_button.place(x=200,y=150)
VM_ip=partial(VM_ip,host_ip)
findIp_button=Button(win,text="Find_IP",command=VM_ip,bg='pale violet red')
findIp_button.place(x=1100,y=150)
go=Button(win,text="GO for scan",command=scan_window,activebackground='green')
go.place(x=600,y=500)
win.mainloop()
